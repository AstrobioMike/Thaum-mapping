Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	208	dl_sample_and_run_mapping
	34	dl_sample_and_run_mapping_HK_samples
	315	parse_gene_level_cov_and_det
	54	parse_gene_level_cov_and_det_HK_samples
	1	run_KO_annotation
	613

[Sun Nov  8 18:01:18 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD154.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD154-gene-coverages.tsv
    jobid: 442
    wildcards: ID=OSD154


        pileup.sh -in ../mapping-files/OSD154.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD154-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD154-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD154-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD154-gene-cov.tmp > ../mapping-files/OSD154-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD154-gene-cov-and-det.tmp ../mapping-files/OSD154-gene-cov.tmp
        

[Sun Nov  8 18:01:18 2020]
rule parse_gene_level_cov_and_det_HK_samples:
    input: ../mapping-files-HK/A3-09-0m-34An.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files-HK/A3-09-0m-34An-gene-coverages.tsv
    jobid: 727
    wildcards: ID=A3-09-0m-34An


        pileup.sh -in ../mapping-files-HK/A3-09-0m-34An.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files-HK/A3-09-0m-34An-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files-HK/A3-09-0m-34An-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files-HK/A3-09-0m-34An-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files-HK/A3-09-0m-34An-gene-cov.tmp > ../mapping-files-HK/A3-09-0m-34An-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files-HK/A3-09-0m-34An-gene-cov-and-det.tmp ../mapping-files-HK/A3-09-0m-34An-gene-cov.tmp
        

[Sun Nov  8 18:01:18 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD20-0.bam
    jobid: 84
    wildcards: ID=OSD20-0


        curr_run_accs=$(grep -w -m 1 "^OSD20-0" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD20-0 ${curr_run_accs}
        

[Sun Nov  8 18:01:18 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD159.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD159-gene-coverages.tsv
    jobid: 448
    wildcards: ID=OSD159


        pileup.sh -in ../mapping-files/OSD159.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD159-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD159-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD159-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD159-gene-cov.tmp > ../mapping-files/OSD159-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD159-gene-cov-and-det.tmp ../mapping-files/OSD159-gene-cov.tmp
        
[Sun Nov  8 18:01:25 2020]
Finished job 727.
1 of 613 steps (0.16%) done

[Sun Nov  8 18:01:25 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_093_35m_0.22-3_prok.bam
    jobid: 232
    wildcards: ID=TARA_093_35m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_093_35m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_093_35m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 18:01:25 2020]
Finished job 442.
2 of 613 steps (0.33%) done

[Sun Nov  8 18:01:25 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_206_5m_0.22-3_prok.bam
    jobid: 330
    wildcards: ID=TARA_206_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_206_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_206_5m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 18:01:25 2020]
Finished job 448.
3 of 613 steps (0.49%) done

[Sun Nov  8 18:01:26 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD58.bam
    jobid: 120
    wildcards: ID=OSD58


        curr_run_accs=$(grep -w -m 1 "^OSD58" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD58 ${curr_run_accs}
        
[Sun Nov  8 18:02:14 2020]
Finished job 84.
4 of 613 steps (0.65%) done

[Sun Nov  8 18:02:14 2020]
rule parse_gene_level_cov_and_det_HK_samples:
    input: ../mapping-files-HK/UW048-33An.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files-HK/UW048-33An-gene-coverages.tsv
    jobid: 777
    wildcards: ID=UW048-33An


        pileup.sh -in ../mapping-files-HK/UW048-33An.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files-HK/UW048-33An-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files-HK/UW048-33An-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files-HK/UW048-33An-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files-HK/UW048-33An-gene-cov.tmp > ../mapping-files-HK/UW048-33An-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files-HK/UW048-33An-gene-cov-and-det.tmp ../mapping-files-HK/UW048-33An-gene-cov.tmp
        
[Sun Nov  8 18:02:20 2020]
Finished job 777.
5 of 613 steps (0.82%) done

[Sun Nov  8 18:02:20 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD47.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD47-gene-coverages.tsv
    jobid: 498
    wildcards: ID=OSD47


        pileup.sh -in ../mapping-files/OSD47.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD47-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD47-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD47-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD47-gene-cov.tmp > ../mapping-files/OSD47-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD47-gene-cov-and-det.tmp ../mapping-files/OSD47-gene-cov.tmp
        
[Sun Nov  8 18:02:25 2020]
Finished job 120.
6 of 613 steps (0.98%) done

[Sun Nov  8 18:02:25 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_112_696m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_112_696m_0.22-3_prok-gene-coverages.tsv
    jobid: 637
    wildcards: ID=TARA_112_696m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_112_696m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_112_696m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_112_696m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_112_696m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_112_696m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_112_696m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_112_696m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_112_696m_0.22-3_prok-gene-cov.tmp
        
[Sun Nov  8 18:02:26 2020]
Finished job 498.
7 of 613 steps (1%) done

[Sun Nov  8 18:02:26 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_068_5m_0.22-0.45_girus.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-coverages.tsv
    jobid: 596
    wildcards: ID=TARA_068_5m_0.22-0.45_girus


        pileup.sh -in ../mapping-files/TARA_068_5m_0.22-0.45_girus.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-cov.tmp > ../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-cov-and-det.tmp ../mapping-files/TARA_068_5m_0.22-0.45_girus-gene-cov.tmp
        
[Sun Nov  8 18:02:58 2020]
Finished job 596.
8 of 613 steps (1%) done

[Sun Nov  8 18:02:58 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_168_10-100m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-coverages.tsv
    jobid: 694
    wildcards: ID=TARA_168_10-100m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_168_10-100m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_168_10-100m_0.22-3_prok-gene-cov.tmp
        
[Sun Nov  8 18:03:06 2020]
Finished job 694.
9 of 613 steps (1%) done

[Sun Nov  8 18:03:06 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_068_50m_0.45-0.8_girus.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-coverages.tsv
    jobid: 595
    wildcards: ID=TARA_068_50m_0.45-0.8_girus


        pileup.sh -in ../mapping-files/TARA_068_50m_0.45-0.8_girus.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-cov.tmp > ../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-cov-and-det.tmp ../mapping-files/TARA_068_50m_0.45-0.8_girus-gene-cov.tmp
        
[Sun Nov  8 18:03:11 2020]
Finished job 637.
10 of 613 steps (2%) done

[Sun Nov  8 18:03:11 2020]
rule parse_gene_level_cov_and_det_HK_samples:
    input: ../mapping-files-HK/UW050-0m-34An.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files-HK/UW050-0m-34An-gene-coverages.tsv
    jobid: 778
    wildcards: ID=UW050-0m-34An


        pileup.sh -in ../mapping-files-HK/UW050-0m-34An.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files-HK/UW050-0m-34An-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files-HK/UW050-0m-34An-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files-HK/UW050-0m-34An-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files-HK/UW050-0m-34An-gene-cov.tmp > ../mapping-files-HK/UW050-0m-34An-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files-HK/UW050-0m-34An-gene-cov-and-det.tmp ../mapping-files-HK/UW050-0m-34An-gene-cov.tmp
        
[Sun Nov  8 18:03:15 2020]
Finished job 778.
11 of 613 steps (2%) done

[Sun Nov  8 18:03:15 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_128_5m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_128_5m_0.22-3_prok-gene-coverages.tsv
    jobid: 665
    wildcards: ID=TARA_128_5m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_128_5m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_128_5m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_128_5m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_128_5m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_128_5m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_128_5m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_128_5m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_128_5m_0.22-3_prok-gene-cov.tmp
        
[Sun Nov  8 18:03:17 2020]
Finished job 595.
12 of 613 steps (2%) done

[Sun Nov  8 18:03:17 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD141.bam
    jobid: 36
    wildcards: ID=OSD141


        curr_run_accs=$(grep -w -m 1 "^OSD141" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD141 ${curr_run_accs}
        
[Sun Nov  8 18:03:21 2020]
Finished job 665.
13 of 613 steps (2%) done

[Sun Nov  8 18:03:22 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_142_5m_0.22-3_prok.bam
    jobid: 284
    wildcards: ID=TARA_142_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_142_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_142_5m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 18:04:07 2020]
Finished job 36.
14 of 613 steps (2%) done

[Sun Nov  8 18:04:07 2020]
rule dl_sample_and_run_mapping_HK_samples:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files-HK/N02-500m-8Ar.bam
    jobid: 368
    wildcards: ID=N02-500m-8Ar


        # getting links to forward and reverse reads
        forward_SRR_acc=$(grep "^N02-500m-8Ar" HK-sample-and-run-accessions.tsv | cut -f 2)
        reverse_SRR_acc=$(grep "^N02-500m-8Ar" HK-sample-and-run-accessions.tsv | cut -f 3)

        R1_link=$(grep "^${forward_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)
        R2_link=$(grep "^${reverse_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)

        bash scripts/dl-and-map-HK-sample.sh ../mapping-files-HK ../mapping-files-HK/all-combined 4 N02-500m-8Ar "${R1_link}" "${R2_link}"
        
[Sun Nov  8 18:13:04 2020]
Finished job 368.
15 of 613 steps (2%) done

[Sun Nov  8 18:13:05 2020]
rule dl_sample_and_run_mapping_HK_samples:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files-HK/UW023-8Ar.bam
    jobid: 382
    wildcards: ID=UW023-8Ar


        # getting links to forward and reverse reads
        forward_SRR_acc=$(grep "^UW023-8Ar" HK-sample-and-run-accessions.tsv | cut -f 2)
        reverse_SRR_acc=$(grep "^UW023-8Ar" HK-sample-and-run-accessions.tsv | cut -f 3)

        R1_link=$(grep "^${forward_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)
        R2_link=$(grep "^${reverse_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)

        bash scripts/dl-and-map-HK-sample.sh ../mapping-files-HK ../mapping-files-HK/all-combined 4 UW023-8Ar "${R1_link}" "${R2_link}"
        
[Sun Nov  8 18:27:34 2020]
Finished job 382.
16 of 613 steps (3%) done

[Sun Nov  8 18:27:35 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD178.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD178-gene-coverages.tsv
    jobid: 466
    wildcards: ID=OSD178


        pileup.sh -in ../mapping-files/OSD178.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD178-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD178-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD178-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD178-gene-cov.tmp > ../mapping-files/OSD178-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD178-gene-cov-and-det.tmp ../mapping-files/OSD178-gene-cov.tmp
        
[Sun Nov  8 18:27:43 2020]
Finished job 466.
17 of 613 steps (3%) done

[Sun Nov  8 18:27:43 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_125_5m_0.22-0.45_girus.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-coverages.tsv
    jobid: 662
    wildcards: ID=TARA_125_5m_0.22-0.45_girus


        pileup.sh -in ../mapping-files/TARA_125_5m_0.22-0.45_girus.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-cov.tmp > ../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-cov-and-det.tmp ../mapping-files/TARA_125_5m_0.22-0.45_girus-gene-cov.tmp
        
[Sun Nov  8 18:29:28 2020]
Finished job 662.
18 of 613 steps (3%) done

[Sun Nov  8 18:29:28 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD132.bam
    jobid: 33
    wildcards: ID=OSD132


        curr_run_accs=$(grep -w -m 1 "^OSD132" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD132 ${curr_run_accs}
        
[Sun Nov  8 18:31:18 2020]
Finished job 33.
19 of 613 steps (3%) done

[Sun Nov  8 18:31:18 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD132.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD132-gene-coverages.tsv
    jobid: 424
    wildcards: ID=OSD132


        pileup.sh -in ../mapping-files/OSD132.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD132-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD132-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD132-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD132-gene-cov.tmp > ../mapping-files/OSD132-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD132-gene-cov-and-det.tmp ../mapping-files/OSD132-gene-cov.tmp
        
[Sun Nov  8 18:31:24 2020]
Finished job 424.
20 of 613 steps (3%) done

[Sun Nov  8 18:31:25 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_067_5m_0.45-0.8_girus.bam
    jobid: 201
    wildcards: ID=TARA_067_5m_0.45-0.8_girus


        curr_run_accs=$(grep -w -m 1 "^TARA_067_5m_0.45-0.8_girus" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_067_5m_0.45-0.8_girus ${curr_run_accs}
        
[Sun Nov  8 20:19:53 2020]
Finished job 232.
21 of 613 steps (3%) done

[Sun Nov  8 20:19:54 2020]
rule dl_sample_and_run_mapping_HK_samples:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files-HK/N04-300m-8Ar.bam
    jobid: 369
    wildcards: ID=N04-300m-8Ar


        # getting links to forward and reverse reads
        forward_SRR_acc=$(grep "^N04-300m-8Ar" HK-sample-and-run-accessions.tsv | cut -f 2)
        reverse_SRR_acc=$(grep "^N04-300m-8Ar" HK-sample-and-run-accessions.tsv | cut -f 3)

        R1_link=$(grep "^${forward_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)
        R2_link=$(grep "^${reverse_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)

        bash scripts/dl-and-map-HK-sample.sh ../mapping-files-HK ../mapping-files-HK/all-combined 4 N04-300m-8Ar "${R1_link}" "${R2_link}"
        
[Sun Nov  8 20:26:02 2020]
Finished job 284.
22 of 613 steps (4%) done

[Sun Nov  8 20:26:02 2020]
rule dl_sample_and_run_mapping_HK_samples:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files-HK/UW024-9Ar.bam
    jobid: 383
    wildcards: ID=UW024-9Ar


        # getting links to forward and reverse reads
        forward_SRR_acc=$(grep "^UW024-9Ar" HK-sample-and-run-accessions.tsv | cut -f 2)
        reverse_SRR_acc=$(grep "^UW024-9Ar" HK-sample-and-run-accessions.tsv | cut -f 3)

        R1_link=$(grep "^${forward_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)
        R2_link=$(grep "^${reverse_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)

        bash scripts/dl-and-map-HK-sample.sh ../mapping-files-HK ../mapping-files-HK/all-combined 4 UW024-9Ar "${R1_link}" "${R2_link}"
        
[Sun Nov  8 20:33:16 2020]
Finished job 330.
23 of 613 steps (4%) done

[Sun Nov  8 20:33:16 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD18.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD18-gene-coverages.tsv
    jobid: 467
    wildcards: ID=OSD18


        pileup.sh -in ../mapping-files/OSD18.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD18-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD18-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD18-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD18-gene-cov.tmp > ../mapping-files/OSD18-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD18-gene-cov-and-det.tmp ../mapping-files/OSD18-gene-cov.tmp
        
[Sun Nov  8 20:33:21 2020]
Finished job 467.
24 of 613 steps (4%) done

[Sun Nov  8 20:33:21 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_168_5m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_168_5m_0.22-3_prok-gene-coverages.tsv
    jobid: 696
    wildcards: ID=TARA_168_5m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_168_5m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_168_5m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_168_5m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_168_5m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_168_5m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_168_5m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_168_5m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_168_5m_0.22-3_prok-gene-cov.tmp
        
[Sun Nov  8 20:33:27 2020]
Finished job 696.
25 of 613 steps (4%) done

[Sun Nov  8 20:33:27 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_096_5m_0.22-3_prok.bam
    jobid: 235
    wildcards: ID=TARA_096_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_096_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_096_5m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 20:36:36 2020]
Finished job 383.
26 of 613 steps (4%) done

[Sun Nov  8 20:36:37 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_068_5m_0.45-0.8_girus.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-coverages.tsv
    jobid: 598
    wildcards: ID=TARA_068_5m_0.45-0.8_girus


        pileup.sh -in ../mapping-files/TARA_068_5m_0.45-0.8_girus.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-cov.tmp > ../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-cov-and-det.tmp ../mapping-files/TARA_068_5m_0.45-0.8_girus-gene-cov.tmp
        
[Sun Nov  8 20:36:47 2020]
Finished job 598.
27 of 613 steps (4%) done

[Sun Nov  8 20:36:47 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_209_5m_0.22-3_prok.bam
    jobid: 333
    wildcards: ID=TARA_209_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_209_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_209_5m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 20:40:11 2020]
Finished job 201.
28 of 613 steps (5%) done

[Sun Nov  8 20:40:11 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_209_351m_0.22-3_prok.bam
    jobid: 332
    wildcards: ID=TARA_209_351m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_209_351m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_209_351m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 22:21:40 2020]
Finished job 333.
29 of 613 steps (5%) done

[Sun Nov  8 22:21:40 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_062_5m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_062_5m_0.22-3_prok-gene-coverages.tsv
    jobid: 585
    wildcards: ID=TARA_062_5m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_062_5m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_062_5m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_062_5m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_062_5m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_062_5m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_062_5m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_062_5m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_062_5m_0.22-3_prok-gene-cov.tmp
        
[Sun Nov  8 22:21:46 2020]
Finished job 585.
30 of 613 steps (5%) done

[Sun Nov  8 22:21:46 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_173_35m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_173_35m_0.22-3_prok-gene-coverages.tsv
    jobid: 697
    wildcards: ID=TARA_173_35m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_173_35m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_173_35m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_173_35m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_173_35m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_173_35m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_173_35m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_173_35m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_173_35m_0.22-3_prok-gene-cov.tmp
        
[Sun Nov  8 22:21:52 2020]
Finished job 697.
31 of 613 steps (5%) done

[Sun Nov  8 22:21:52 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_094_5m_0.22-3_prok.bam
    jobid: 234
    wildcards: ID=TARA_094_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_094_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_094_5m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 22:49:46 2020]
Finished job 235.
32 of 613 steps (5%) done

[Sun Nov  8 22:49:47 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_098_188m_0.22-3_prok.bam
    jobid: 236
    wildcards: ID=TARA_098_188m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_098_188m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_098_188m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 22:58:23 2020]
Finished job 369.
33 of 613 steps (5%) done

[Sun Nov  8 22:58:24 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_210_391m_0.22-3_prok.bam
    jobid: 334
    wildcards: ID=TARA_210_391m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_210_391m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_210_391m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 23:11:48 2020]
Finished job 236.
34 of 613 steps (6%) done

[Sun Nov  8 23:11:49 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_173_5m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_173_5m_0.22-3_prok-gene-coverages.tsv
    jobid: 698
    wildcards: ID=TARA_173_5m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_173_5m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_173_5m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_173_5m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_173_5m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_173_5m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_173_5m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_173_5m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_173_5m_0.22-3_prok-gene-cov.tmp
        
[Sun Nov  8 23:12:03 2020]
Finished job 698.
35 of 613 steps (6%) done

[Sun Nov  8 23:12:03 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_098_488m_0.22-3_prok.bam
    jobid: 237
    wildcards: ID=TARA_098_488m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_098_488m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_098_488m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 23:26:30 2020]
Finished job 332.
36 of 613 steps (6%) done

[Sun Nov  8 23:26:30 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_210_5m_0.22-3_prok.bam
    jobid: 335
    wildcards: ID=TARA_210_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_210_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_210_5m_0.22-3_prok ${curr_run_accs}
        
[Sun Nov  8 23:51:11 2020]
Finished job 237.
37 of 613 steps (6%) done

[Sun Nov  8 23:51:12 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD5-1.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD5-1-gene-coverages.tsv
    jobid: 503
    wildcards: ID=OSD5-1


        pileup.sh -in ../mapping-files/OSD5-1.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD5-1-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD5-1-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD5-1-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD5-1-gene-cov.tmp > ../mapping-files/OSD5-1-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD5-1-gene-cov-and-det.tmp ../mapping-files/OSD5-1-gene-cov.tmp
        
[Sun Nov  8 23:51:21 2020]
Finished job 503.
38 of 613 steps (6%) done

[Sun Nov  8 23:51:21 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_070_5m_0.22-0.45_girus.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-coverages.tsv
    jobid: 601
    wildcards: ID=TARA_070_5m_0.22-0.45_girus


        pileup.sh -in ../mapping-files/TARA_070_5m_0.22-0.45_girus.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-cov.tmp > ../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-cov-and-det.tmp ../mapping-files/TARA_070_5m_0.22-0.45_girus-gene-cov.tmp
        
[Sun Nov  8 23:51:29 2020]
Finished job 601.
39 of 613 steps (6%) done

[Sun Nov  8 23:51:29 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_098_5m_0.22-3_prok.bam
    jobid: 238
    wildcards: ID=TARA_098_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_098_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_098_5m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 00:06:21 2020]
Finished job 238.
40 of 613 steps (7%) done

[Mon Nov  9 00:06:21 2020]
rule run_KO_annotation:
    input: ../genes-and-annotations/all-genes.faa
    output: ../genes-and-annotations/KO-annotations.tsv
    jobid: 784


        exec_annotation -p ${KO_DIR}/profiles/ -k ${KO_DIR}/ko_list --cpu 4 -f detail-tsv -o ../genes-and-annotations/KO-tab.tmp --tmp-dir ../genes-and-annotations/tmp-KO-dir --report-unannotated ../genes-and-annotations/all-genes.faa 
        bit-filter-KOFamScan-results -i ../genes-and-annotations/KO-tab.tmp -o ../genes-and-annotations/KO-annotations.tsv
        rm -rf ../genes-and-annotations/KO-tab.tmp ../genes-and-annotations/tmp-KO-dir 
        
[Mon Nov  9 00:57:41 2020]
Finished job 234.
41 of 613 steps (7%) done

[Mon Nov  9 00:57:41 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_099_5m_0.22-3_prok.bam
    jobid: 239
    wildcards: ID=TARA_099_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_099_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_099_5m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 01:23:31 2020]
Finished job 335.
42 of 613 steps (7%) done

[Mon Nov  9 01:23:31 2020]
rule dl_sample_and_run_mapping_HK_samples:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files-HK/A3-09-1000m-34An.bam
    jobid: 337
    wildcards: ID=A3-09-1000m-34An


        # getting links to forward and reverse reads
        forward_SRR_acc=$(grep "^A3-09-1000m-34An" HK-sample-and-run-accessions.tsv | cut -f 2)
        reverse_SRR_acc=$(grep "^A3-09-1000m-34An" HK-sample-and-run-accessions.tsv | cut -f 3)

        R1_link=$(grep "^${forward_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)
        R2_link=$(grep "^${reverse_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)

        bash scripts/dl-and-map-HK-sample.sh ../mapping-files-HK ../mapping-files-HK/all-combined 4 A3-09-1000m-34An "${R1_link}" "${R2_link}"
        
[Mon Nov  9 01:31:50 2020]
Finished job 337.
43 of 613 steps (7%) done

[Mon Nov  9 01:31:50 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_070_5m_0.45-0.8_girus.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-coverages.tsv
    jobid: 603
    wildcards: ID=TARA_070_5m_0.45-0.8_girus


        pileup.sh -in ../mapping-files/TARA_070_5m_0.45-0.8_girus.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-cov.tmp > ../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-cov-and-det.tmp ../mapping-files/TARA_070_5m_0.45-0.8_girus-gene-cov.tmp
        
[Mon Nov  9 01:32:02 2020]
Finished job 603.
44 of 613 steps (7%) done

[Mon Nov  9 01:32:02 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD60.bam
    jobid: 122
    wildcards: ID=OSD60


        curr_run_accs=$(grep -w -m 1 "^OSD60" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD60 ${curr_run_accs}
        
[Mon Nov  9 01:33:53 2020]
Finished job 122.
45 of 613 steps (7%) done

[Mon Nov  9 01:33:53 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_168_40m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_168_40m_0.22-3_prok-gene-coverages.tsv
    jobid: 695
    wildcards: ID=TARA_168_40m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_168_40m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_168_40m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_168_40m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_168_40m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_168_40m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_168_40m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_168_40m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_168_40m_0.22-3_prok-gene-cov.tmp
        
[Mon Nov  9 01:34:03 2020]
Finished job 695.
46 of 613 steps (8%) done

[Mon Nov  9 01:34:03 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_175_5m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_175_5m_0.22-3_prok-gene-coverages.tsv
    jobid: 701
    wildcards: ID=TARA_175_5m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_175_5m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_175_5m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_175_5m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_175_5m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_175_5m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_175_5m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_175_5m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_175_5m_0.22-3_prok-gene-cov.tmp
        
[Mon Nov  9 01:34:15 2020]
Finished job 701.
47 of 613 steps (8%) done

[Mon Nov  9 01:34:15 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_208_5m_0.22-3_prok.bam
    jobid: 331
    wildcards: ID=TARA_208_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_208_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_208_5m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 01:35:52 2020]
Finished job 334.
48 of 613 steps (8%) done

[Mon Nov  9 01:35:52 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_110_380m_0.22-3_prok.bam
    jobid: 240
    wildcards: ID=TARA_110_380m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_110_380m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_110_380m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 02:49:47 2020]
Finished job 239.
49 of 613 steps (8%) done

[Mon Nov  9 02:49:47 2020]
rule dl_sample_and_run_mapping_HK_samples:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files-HK/A3-09-300m-34An.bam
    jobid: 338
    wildcards: ID=A3-09-300m-34An


        # getting links to forward and reverse reads
        forward_SRR_acc=$(grep "^A3-09-300m-34An" HK-sample-and-run-accessions.tsv | cut -f 2)
        reverse_SRR_acc=$(grep "^A3-09-300m-34An" HK-sample-and-run-accessions.tsv | cut -f 3)

        R1_link=$(grep "^${forward_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)
        R2_link=$(grep "^${reverse_SRR_acc}" HK-SRRs-and-links.tsv | cut -f 2)

        bash scripts/dl-and-map-HK-sample.sh ../mapping-files-HK ../mapping-files-HK/all-combined 4 A3-09-300m-34An "${R1_link}" "${R2_link}"
        
[Mon Nov  9 02:57:56 2020]
Finished job 338.
50 of 613 steps (8%) done

[Mon Nov  9 02:57:56 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD54.bam
    jobid: 115
    wildcards: ID=OSD54


        curr_run_accs=$(grep -w -m 1 "^OSD54" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD54 ${curr_run_accs}
        
[Mon Nov  9 02:59:26 2020]
Finished job 115.
51 of 613 steps (8%) done

[Mon Nov  9 02:59:26 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD54.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD54-gene-coverages.tsv
    jobid: 506
    wildcards: ID=OSD54


        pileup.sh -in ../mapping-files/OSD54.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD54-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD54-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD54-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD54-gene-cov.tmp > ../mapping-files/OSD54-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD54-gene-cov-and-det.tmp ../mapping-files/OSD54-gene-cov.tmp
        
[Mon Nov  9 02:59:37 2020]
Finished job 506.
52 of 613 steps (8%) done

[Mon Nov  9 02:59:37 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_110_50m_0.22-3_prok.bam
    jobid: 241
    wildcards: ID=TARA_110_50m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_110_50m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_110_50m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 03:41:11 2020]
Finished job 331.
53 of 613 steps (9%) done

[Mon Nov  9 03:41:12 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_123_150m_0.1-0.22_girus.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-coverages.tsv
    jobid: 647
    wildcards: ID=TARA_123_150m_0.1-0.22_girus


        pileup.sh -in ../mapping-files/TARA_123_150m_0.1-0.22_girus.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-cov.tmp > ../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-cov-and-det.tmp ../mapping-files/TARA_123_150m_0.1-0.22_girus-gene-cov.tmp
        
[Mon Nov  9 03:41:23 2020]
Finished job 647.
54 of 613 steps (9%) done

[Mon Nov  9 03:41:23 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_093_5m_0.22-3_prok.bam
    jobid: 233
    wildcards: ID=TARA_093_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_093_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_093_5m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 04:21:24 2020]
Finished job 240.
55 of 613 steps (9%) done

[Mon Nov  9 04:21:25 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD100.bam
    jobid: 4
    wildcards: ID=OSD100


        curr_run_accs=$(grep -w -m 1 "^OSD100" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD100 ${curr_run_accs}
        
[Mon Nov  9 04:22:25 2020]
Finished job 4.
56 of 613 steps (9%) done

[Mon Nov  9 04:22:25 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD6.bam
    jobid: 121
    wildcards: ID=OSD6


        curr_run_accs=$(grep -w -m 1 "^OSD6" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD6 ${curr_run_accs}
        
[Mon Nov  9 04:23:16 2020]
Finished job 121.
57 of 613 steps (9%) done

[Mon Nov  9 04:23:16 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD46.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD46-gene-coverages.tsv
    jobid: 497
    wildcards: ID=OSD46


        pileup.sh -in ../mapping-files/OSD46.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD46-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD46-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD46-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD46-gene-cov.tmp > ../mapping-files/OSD46-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD46-gene-cov-and-det.tmp ../mapping-files/OSD46-gene-cov.tmp
        
[Mon Nov  9 04:23:27 2020]
Finished job 497.
58 of 613 steps (9%) done

[Mon Nov  9 04:23:27 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD115.bam
    jobid: 18
    wildcards: ID=OSD115


        curr_run_accs=$(grep -w -m 1 "^OSD115" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD115 ${curr_run_accs}
        
[Mon Nov  9 04:24:10 2020]
Finished job 18.
59 of 613 steps (10%) done

[Mon Nov  9 04:24:10 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_206_411m_0.22-3_prok.bam
    jobid: 329
    wildcards: ID=TARA_206_411m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_206_411m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_206_411m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 04:25:05 2020]
Finished job 784.
60 of 613 steps (10%) done

[Mon Nov  9 04:25:05 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD15-0.bam
    jobid: 46
    wildcards: ID=OSD15-0


        curr_run_accs=$(grep -w -m 1 "^OSD15-0" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD15-0 ${curr_run_accs}
        
[Mon Nov  9 04:26:05 2020]
Finished job 46.
61 of 613 steps (10%) done

[Mon Nov  9 04:26:06 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_085_790m_0.22-3_prok.bam
    jobid: 231
    wildcards: ID=TARA_085_790m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_085_790m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_085_790m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 05:03:33 2020]
Finished job 233.
62 of 613 steps (10%) done

[Mon Nov  9 05:03:35 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD164.bam
    jobid: 60
    wildcards: ID=OSD164


        curr_run_accs=$(grep -w -m 1 "^OSD164" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD164 ${curr_run_accs}
        
[Mon Nov  9 05:05:21 2020]
Finished job 60.
63 of 613 steps (10%) done

[Mon Nov  9 05:05:21 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD24.bam
    jobid: 88
    wildcards: ID=OSD24


        curr_run_accs=$(grep -w -m 1 "^OSD24" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD24 ${curr_run_accs}
        
[Mon Nov  9 05:07:09 2020]
Finished job 88.
64 of 613 steps (10%) done

[Mon Nov  9 05:07:09 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD45.bam
    jobid: 105
    wildcards: ID=OSD45


        curr_run_accs=$(grep -w -m 1 "^OSD45" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD45 ${curr_run_accs}
        
[Mon Nov  9 05:08:28 2020]
Finished job 105.
65 of 613 steps (11%) done

[Mon Nov  9 05:08:28 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/OSD45.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/OSD45-gene-coverages.tsv
    jobid: 496
    wildcards: ID=OSD45


        pileup.sh -in ../mapping-files/OSD45.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/OSD45-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/OSD45-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/OSD45-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/OSD45-gene-cov.tmp > ../mapping-files/OSD45-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/OSD45-gene-cov-and-det.tmp ../mapping-files/OSD45-gene-cov.tmp
        
[Mon Nov  9 05:08:34 2020]
Finished job 496.
66 of 613 steps (11%) done

[Mon Nov  9 05:08:34 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_023_55m_0.22-1.6_prok.bam
    jobid: 158
    wildcards: ID=TARA_023_55m_0.22-1.6_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_023_55m_0.22-1.6_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_023_55m_0.22-1.6_prok ${curr_run_accs}
        
[Mon Nov  9 05:12:43 2020]
Finished job 231.
67 of 613 steps (11%) done

[Mon Nov  9 05:12:44 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_142_640m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_142_640m_0.22-3_prok-gene-coverages.tsv
    jobid: 676
    wildcards: ID=TARA_142_640m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_142_640m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_142_640m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_142_640m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_142_640m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_142_640m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_142_640m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_142_640m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_142_640m_0.22-3_prok-gene-cov.tmp
        
[Mon Nov  9 05:13:35 2020]
Finished job 676.
68 of 613 steps (11%) done

[Mon Nov  9 05:13:35 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_112_5m_0.22-3_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_112_5m_0.22-3_prok-gene-coverages.tsv
    jobid: 636
    wildcards: ID=TARA_112_5m_0.22-3_prok


        pileup.sh -in ../mapping-files/TARA_112_5m_0.22-3_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_112_5m_0.22-3_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_112_5m_0.22-3_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_112_5m_0.22-3_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_112_5m_0.22-3_prok-gene-cov.tmp > ../mapping-files/TARA_112_5m_0.22-3_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_112_5m_0.22-3_prok-gene-cov-and-det.tmp ../mapping-files/TARA_112_5m_0.22-3_prok-gene-cov.tmp
        
[Mon Nov  9 05:13:39 2020]
Finished job 636.
69 of 613 steps (11%) done

[Mon Nov  9 05:13:39 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD101.bam
    jobid: 5
    wildcards: ID=OSD101


        curr_run_accs=$(grep -w -m 1 "^OSD101" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD101 ${curr_run_accs}
        
[Mon Nov  9 05:14:37 2020]
Finished job 5.
70 of 613 steps (11%) done

[Mon Nov  9 05:14:37 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_205_5m_0.22-3_prok.bam
    jobid: 328
    wildcards: ID=TARA_205_5m_0.22-3_prok


        curr_run_accs=$(grep -w -m 1 "^TARA_205_5m_0.22-3_prok" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_205_5m_0.22-3_prok ${curr_run_accs}
        
[Mon Nov  9 05:14:42 2020]
Finished job 241.
71 of 613 steps (12%) done

[Mon Nov  9 05:14:42 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/OSD116.bam
    jobid: 19
    wildcards: ID=OSD116


        curr_run_accs=$(grep -w -m 1 "^OSD116" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 OSD116 ${curr_run_accs}
        
[Mon Nov  9 05:15:21 2020]
Finished job 19.
72 of 613 steps (12%) done

[Mon Nov  9 05:15:21 2020]
rule dl_sample_and_run_mapping:
    input: ../mapping-files/all-combined.1.bt2, ../mapping-files/all-combined.2.bt2, ../mapping-files/all-combined.3.bt2, ../mapping-files/all-combined.rev.1.bt2, ../mapping-files/all-combined.rev.2.bt2
    output: ../mapping-files/TARA_078_800m_0.45-0.8_girus.bam
    jobid: 230
    wildcards: ID=TARA_078_800m_0.45-0.8_girus


        curr_run_accs=$(grep -w -m 1 "^TARA_078_800m_0.45-0.8_girus" sample-and-run-accessions.tsv | cut -f 2)
        bash scripts/dl-and-map-sample.sh ../mapping-files ../mapping-files/all-combined 4 TARA_078_800m_0.45-0.8_girus ${curr_run_accs}
        
[Mon Nov  9 05:20:32 2020]
Finished job 158.
73 of 613 steps (12%) done

[Mon Nov  9 05:20:32 2020]
rule parse_gene_level_cov_and_det:
    input: ../mapping-files/TARA_023_55m_0.22-1.6_prok.bam, ../genes-and-annotations/all-genes.fa
    output: ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-coverages.tsv
    jobid: 549
    wildcards: ID=TARA_023_55m_0.22-1.6_prok


        pileup.sh -in ../mapping-files/TARA_023_55m_0.22-1.6_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov.tmp > ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov-and-det.tmp ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov.tmp
        
[Mon Nov  9 05:20:32 2020]
Error in rule parse_gene_level_cov_and_det:
    jobid: 549
    output: ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-coverages.tsv
    shell:
        
        pileup.sh -in ../mapping-files/TARA_023_55m_0.22-1.6_prok.bam fastaorf=../genes-and-annotations/all-genes.fa outorf=../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov-and-det.tmp > /dev/null 2>&1

        # filtering coverages based on detection
        grep -v "#" ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov-and-det.tmp | awk -F $'	' ' BEGIN {OFS=FS} { if ( $10 <= 0.5 ) $4 = 0 } { print $1,$4 } ' > ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov.tmp
        cat <( printf "gene_ID	coverage
" ) ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov.tmp > ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-coverages.tsv

          # removing intermediate files
        rm ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov-and-det.tmp ../mapping-files/TARA_023_55m_0.22-1.6_prok-gene-cov.tmp
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Mon Nov  9 06:29:25 2020]
Finished job 230.
74 of 613 steps (12%) done
[Mon Nov  9 06:35:07 2020]
Finished job 329.
75 of 613 steps (12%) done
[Mon Nov  9 06:41:11 2020]
Finished job 328.
76 of 613 steps (12%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /data2/mlee/Thaum/metagenome-dl-and-mapping-workflow/.snakemake/log/2020-11-08T180117.019997.snakemake.log
